<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成就系统测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #FFD700;
        }
        
        .test-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
        }
        
        button#reset {
            background: #f44336;
        }
        
        .achievement-display {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 30px;
        }
        
        .achievement-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .achievement-item.locked {
            opacity: 0.5;
        }
        
        .achievement-image {
            width: 100%;
            height: 150px;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .achievement-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .achievement-status {
            font-size: 14px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>成就系统测试页面</h1>
        
        <div class="test-buttons">
            <button id="unlockAll">解锁所有成就</button>
            <button id="reset">重置所有成就</button>
        </div>
        
        <div class="achievement-display" id="achievementDisplay">
            <!-- 成就将通过JavaScript动态加载 -->
        </div>
    </div>

    <script>
        // 成就图片路径数组
        const achievementImages = [
            "./成就系统照片/糊涂侦探.png",
            "./成就系统照片/明察秋毫.png",
            "./成就系统照片/蛛丝已成罗网.png",
            "./成就系统照片/乐不思蜀.png",
            "./成就系统照片/清汤大老爷.png"
        ];
        
        // 成就名称
        const achievementNames = [
            "糊涂侦探",
            "明察秋毫",
            "蛛丝已成罗网",
            "乐不思蜀",
            "清汤大老爷"
        ];
        
        // 检查成就是否已解锁
        function isAchievementUnlocked(index) {
            const currentUsername = localStorage.getItem("Sec-Sight-current-username") || "default";
            const file = localStorage.getItem("second_sight_achievements_" + currentUsername);
            let achievements = file ? JSON.parse(file) : {};
            
            // 假设成就ID与图片索引对应
            const achievementIds = [
                "糊涂侦探",
                "明察秋毫",
                "蛛丝已成罗网",
                "乐不思蜀",
                "清汤大老爷"
            ];
            
            return !!achievements[achievementIds[index]];
        }
        
        // 解锁成就
        function unlockAchievement(index) {
            const currentUsername = localStorage.getItem("Sec-Sight-current-username") || "default";
            const file = localStorage.getItem("second_sight_achievements_" + currentUsername);
            let achievements = file ? JSON.parse(file) : {};
            
            // 假设成就ID与图片索引对应
            const achievementIds = [
                "糊涂侦探",
                "明察秋毫",
                "蛛丝已成罗网",
                "乐不思蜀",
                "清汤大老爷"
            ];
            
            achievements[achievementIds[index]] = true;
            localStorage.setItem("second_sight_achievements_" + currentUsername, JSON.stringify(achievements));
            
            renderAchievements();
        }
        
        // 解锁所有成就
        function unlockAllAchievements() {
            for (let i = 0; i < achievementImages.length; i++) {
                unlockAchievement(i);
            }
        }
        
        // 重置所有成就
        function resetAllAchievements() {
            const currentUsername = localStorage.getItem("Sec-Sight-current-username") || "default";
            localStorage.setItem("second_sight_achievements_" + currentUsername, JSON.stringify({}));
            renderAchievements();
        }
        
        // 渲染成就显示
        function renderAchievements() {
            const container = document.getElementById('achievementDisplay');
            container.innerHTML = '';
            
            achievementImages.forEach((imgSrc, index) => {
                const discovered = isAchievementUnlocked(index);
                const item = document.createElement('div');
                item.className = `achievement-item ${discovered ? '' : 'locked'}`;
                
                item.innerHTML = `
                    <div class="achievement-image" style="background-image: url(${imgSrc});"></div>
                    <div class="achievement-name">${achievementNames[index]}</div>
                    <div class="achievement-status">${discovered ? '已解锁' : '未解锁'}</div>
                `;
                
                if (!discovered) {
                    item.addEventListener('click', () => {
                        unlockAchievement(index);
                        alert(`成就已解锁: ${achievementNames[index]}`);
                    });
                }
                
                container.appendChild(item);
            });
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            renderAchievements();
            
            // 绑定按钮事件
            document.getElementById('unlockAll').addEventListener('click', unlockAllAchievements);
            document.getElementById('reset').addEventListener('click', resetAllAchievements);
        });
    </script>
</body>
</html>